<!DOCTYPE html>
<html lang="en">
	<head>
  		<title>Animal Crossing Birthdays</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width initial-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <script src="js/jquery-3.4.1.min.js"></script>
        <meta name="description" content="Study Animal Crossing Birthdays">
    </head>
    <body>
        <header>
            <h1>Let's Study Animal Crossing Birthdays!</h1>
        </header>
    	<main>
    		<h2 id="name"></h2>
            <section>
                <img id="image" />
                <h3 id="birthday"></h3>
            </section>
            <script type="text/javascript">
                var characters = [];

                $.getJSON("birthdays.json", function(json) {
                    $.each(json, function () {
                        var obj = this;
                        var imageUrl = "img/"+obj["name"]+".png";

                        $.ajax({
                            url: imageUrl,
                            success: function(html) {
                                var char = {  
                                    name: obj["name"],
                                    birthday: obj["birthday"],
                                    image: imageUrl
                                };
                                characters.push(char);
                            },
                            async:false
                        });
                    });

                    console.log("here");
                    characters = shuffle(characters);
                    load(characters[0]);
                });
                
                /**
                 * Shuffles array in place.
                 * @param {Array} a items An array containing the items.
                 * https://stackoverflow.com/a/6274381/4102299
                 */
                function shuffle(a) {
                    var j, x, i;
                    for (i = a.length - 1; i > 0; i--) {
                        j = Math.floor(Math.random() * (i + 1));
                        x = a[i];
                        a[i] = a[j];
                        a[j] = x;
                    }
                    return a;
                }
 
                function load(obj) {
                    $("#name").text(obj["name"]);
                    $("#image").attr("src", obj["image"]);
                    $("#birthday").text(obj["birthday"]);
                }

            </script>
    	</main>
        <footer>
        </footer>
    </body>
</html>